# Confluence CVE-2023-22515 — TryHackMe - Web Application Confluence

**Date:** 2026-01-15  
**Type:** TryHackMe  
**Scope:** Lab / Authorized only

---

## 1) Context

This lab covers **CVE-2023-22515**, a critical broken access control vulnerability in Atlassian Confluence Server and Data Center.  
The objective was to understand how application setup logic can be abused post-installation to gain **full administrative access without authentication**.

---

## 2) Initial hypothesis

The hypothesis was that Confluence’s initial setup state could be manipulated after installation, allowing the setup wizard to be re-triggered and abused to create a new administrator account.

---

## 3) Tools used

- Web browser  
- Burp Suite (proxy & repeater)  
- HTTP request inspection tools  

*(No credentials, secrets, or exploit scripts were used in this write-up.)*

---

## 4) Approach (high level)

- Analyze Confluence’s **initial setup workflow** and how it is marked as “completed”
- Identify **trust boundaries** around setup-related endpoints
- Study how **Apache Struts / XWork parameter binding** handles request parameters
- Trace object access paths exposed through framework-level getters and setters
- Test whether internal configuration values could be modified through request parameters
- Re-access the setup workflow after manipulating application state

---

## 5) Results / Evidence (sanitized)

- The application accepted a crafted request that modified its internal “setup completed” state
- The setup wizard became accessible again on a post-installation instance
- A new administrator account could be created through the normal setup flow
- Final observed state: **unauthenticated privilege escalation to full administrator**

No database access, secrets, or internal dumps were required to demonstrate impact.

---

## 6) Recommended remediation

- Enforce **strict access control** on all setup and bootstrap endpoints
- Prevent exposure of sensitive internal objects through parameter binding
- Use **immutable or write-once flags** for installation state
- Apply **transactional controls and internal authorization checks**
- Implement monitoring and alerting for access to unused or legacy endpoints
- Upgrade to patched versions and apply vendor security advisories promptly

---

## 7) Lessons learned

- Broken access control can originate from **framework features**, not just custom code
- Exposing internal setters is as dangerous as classic injection flaws
- Application bootstrap logic is a **high-risk attack surface**
- CVSS 10.0 vulnerabilities are often trivial to exploit
- Following **object hierarchies** can reveal unexpected attack paths

---

## 8) Links / Resources

- TryHackMe room: Confluence (Web Application)  
- Atlassian security advisory: CVE-2023-22515  
- AttackerKB technical analysis  
- Public notes / extended write-up (if applicable)

---
