# Sudo Security Bypass — TryHackMe - Sudo Hack

**Date:** 2026-01-18  
**Type:** TryHackMe  
**Scope:** Lab / Authorized only

---

## 1) Context

Tutorial lab from the *SudoVulns* series on TryHackMe, focused on understanding and exploiting **CVE-2019-14287**, a logic flaw in sudo’s user ID handling that can lead to local privilege escalation under specific sudoers configurations.

---

## 2) Initial hypothesis

If sudo permissions allow execution as any user except root, there may be an edge case in how sudo interprets user identifiers that could bypass the explicit `!root` restriction.

---

## 3) Tools used

- sudo  
- Linux shell utilities  

*(No sensitive options, credentials, or custom exploit scripts used)*

---

## 4) Approach (high level)

- Reviewed how sudo enforces user restrictions via `/etc/sudoers`
- Analyzed differences between username-based and UID-based execution
- Studied the CVE documentation to understand the underlying logic flaw
- Tested edge-case UID handling under a restricted sudo configuration
- Observed whether sudo correctly enforced the intended access controls

---

## 5) Results / Evidence (sanitized)

- A sudoers rule explicitly denying execution as root was bypassed
- Sudo accepted an invalid numeric UID and executed the command with root privileges
- Final observed state: **command executed with full administrative rights despite explicit deny rule**

This confirmed the presence and exploitability of **CVE-2019-14287** in the lab environment.

---

## 6) Recommended remediation

- Upgrade sudo to a patched version (≥ 1.8.28)
- Avoid sudoers rules relying solely on exclusions like `!root`
- Restrict or disable numeric UID execution where not required
- Apply least-privilege principles when delegating sudo access
- Regularly audit and test privilege escalation paths against edge cases

---

## 7) Lessons learned

- Access control failures often stem from subtle logic errors, not misconfiguration
- Numeric identifiers (UIDs) can introduce unexpected attack surfaces
- Explicit deny rules are ineffective if input validation is flawed
- Local privilege escalation usually depends on *existing*, seemingly safe permissions

---

## 8) Links / Resources

- TryHackMe Room: *Sudo Security Bypass*  
- CVE-2019-14287 advisory  
- Sudo project security notes  
- Public learning notes (Notion)

---
