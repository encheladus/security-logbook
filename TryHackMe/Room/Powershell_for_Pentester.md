# PowerShell for Pentesters — TryHackMe

**Date:** 2026-01-16  
**Type:** TryHackMe  
**Scope:** Lab / Authorized only

---

## 1) Context

This lab introduces the core uses of PowerShell in penetration testing, focusing on file interaction, system and network reconnaissance, and post-exploitation enumeration.  
The objective is to understand how PowerShell can be leveraged for “living off the land” techniques while remaining efficient and stealthy.

---

## 2) Initial hypothesis

The room would cover fundamental PowerShell concepts and native cmdlets that are broadly applicable during engagements, without relying heavily on external offensive frameworks.

---

## 3) Tools used

- Native PowerShell cmdlets  
- Built-in Windows utilities  
- Optional reconnaissance scripts (e.g., PowerView)  
- Output formatting and export mechanisms  

---

## 4) Approach (high level)

- Reviewed PowerShell basics relevant to offensive operations  
- Manipulated files and processes using native cmdlets  
- Practiced downloading remote files and handling execution restrictions  
- Enumerated system information such as installed patches and file metadata  
- Performed basic network reconnaissance using PowerShell pipelines  
- Explored Active Directory enumeration concepts with PowerView  
- Focused on minimizing noise and detection through filtering and formatting  

---

## 5) Results / Evidence (sanitized)

- Successfully enumerated running processes, files, and system metadata  
- Retrieved and analyzed installed patch information to assess system hygiene  
- Identified reachable hosts and open services within a local network range  
- Enumerated Active Directory objects (users, computers, groups, shares, trusts) in a lab context  
- Demonstrated that native PowerShell cmdlets can replicate much of the functionality of common reconnaissance tools  

Final state: reconnaissance objectives achieved using mostly native tooling with controlled output and minimal detection surface.

---

## 6) Recommended remediation

- Enforce proper system patching and update cycles  
- Monitor and restrict abnormal PowerShell usage patterns  
- Combine execution policy controls with endpoint detection and response (EDR)  
- Limit excessive user privileges and local administrator access  
- Audit Active Directory configurations, group memberships, and trust relationships  
- Harden logging and alerting around PowerShell activity  

---

## 7) Lessons learned

- PowerShell is an object-oriented interface to Windows, not just a scripting language  
- ExecutionPolicy is a safety mechanism, not a security boundary  
- Well-known offensive scripts are heavily signatured by antivirus and EDR solutions  
- Native cmdlets offer powerful reconnaissance capabilities with lower detection risk  
- Output control (filtering, formatting, exporting) is critical for operational efficiency  
- Small operational choices can significantly impact stealth during engagements  

---

## 8) Links / Resources

- TryHackMe — PowerShell for Pentesters room  
- PowerSploit / PowerView documentation  
- Microsoft PowerShell documentation  
- Personal notes / extended write-up (public)