# Roundcube RCE via Unsafe Deserialization — TryHackMe

**Date:** 2026-02-03  
**Type:** TryHackMe  
**Scope:** Lab / Authorized only

---

## 1) Context

Analysis and exploitation of **CVE-2025-49113**, a critical unsafe PHP deserialization vulnerability in Roundcube Webmail affecting versions 1.5.x and 1.6.x prior to patched releases.  
Objective: understand root cause, exploitation path, and defensive fixes leading to post-authenticated RCE.

---

## 2) Initial hypothesis

Given prior public research, the application likely accepts user-controlled input that is later deserialized without strict validation, allowing crafted object injection and command execution after authentication.

---

## 3) Tools used

- PHP (PoC execution)
- Browser (authenticated session interaction)
- Netcat (listener)
- Public PoC reference (GitHub)

---

## 4) Approach (high level)

- Review vulnerability background and affected Roundcube versions
- Understand unsafe deserialization mechanics in PHP
- Identify vulnerable parameter and request flow
- Execute public PoC in a controlled lab environment
- Observe server-side behavior and verify execution context
- Validate exploitation through indirect indicators

---

## 5) Results / Evidence (sanitized)

- Successful post-authenticated **remote code execution**
- Payload processed via vulnerable deserialization path
- Commands executed in web server context
- Final execution context confirmed as application directory
- No sensitive data accessed or persisted

---

## 6) Recommended remediation

- Upgrade to patched versions:
  - 1.5.x → **1.5.10**
  - 1.6.x → **1.6.11**
- Enforce strict input validation before deserialization
- Avoid deserializing user-controlled data
- Apply allowlists for accepted parameters
- Add defensive logging for rejected input
- Restrict access to sensitive endpoints (temporary mitigation)

---

## 7) Lessons learned

- Unsafe deserialization remains a high-impact vulnerability class
- Authentication does not meaningfully reduce risk severity
- Exploit output may be misleading despite successful execution
- Verification often relies on indirect confirmation
- Input validation failures can cascade into full RCE

---

## 8) Links / Resources

- TryHackMe – Known Vulnerability Room  
- CVE-2025-49113 public analysis  
- Roundcube security advisories  
- Public PoC repository (reference only)