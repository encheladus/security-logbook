# GeoServer XXE (CVE-2025-58360) — TryHackMe

**Date:** 2026-02-03  
**Type:** TryHackMe  
**Scope:** Lab / Authorized only

---

## 1) Context

This lab covers a critical XML External Entity (XXE) vulnerability affecting GeoServer (CVE-2025-58360).  
The objective is to understand how XML-based OGC services can be abused to achieve arbitrary file reads and to analyze how such exploitation can be detected through application and access logs.

---

## 2) Initial hypothesis

Before starting, I expected GeoServer to:
- Accept XML payloads via HTTP POST for OGC services
- Use an XML parser with insufficient external entity restrictions
- Be vulnerable to XXE leading to local file disclosure
- Leave detectable traces in application logs rather than access logs

---

## 3) Tools used

- curl  
- Metasploit  
- Elastic / Kibana  
- GeoServer native log viewer  

---

## 4) Approach (high level)

- Analyze GeoServer’s role and exposed OGC services
- Identify XML-based operations accepting POST requests
- Target XML parsing behavior in WMS GetMap requests
- Test for external entity resolution through crafted XML
- Observe server responses for unintended data disclosure
- Investigate application and access logs for exploitation artifacts
- Correlate multiple log sources to reconstruct attacker activity

---

## 5) Results / Evidence (sanitized)

- Successful XML parsing of external entities was observed
- Local system files were disclosed through server error responses
- File contents appeared embedded in application error messages
- Application logs recorded file read output
- Access logs showed POST requests to the WMS endpoint without payload visibility
- Correlation confirmed unauthorized file access via XXE

Final state: **arbitrary file read confirmed through XML External Entity injection**

---

## 6) Recommended remediation

- Disable external entity resolution in XML parsers
- Enforce secure XML processing configurations
- Restrict or disable XML POST support where unnecessary
- Implement input validation and schema enforcement
- Apply version upgrades and vendor security patches
- Centralize and parse application logs for detection
- Monitor anomalous POST requests to geospatial endpoints

---

## 7) Lessons learned

- XML-based services remain a high-risk attack surface
- Critical vulnerabilities can exist in widely deployed infrastructure software
- Application logs often reveal attack impact, not access logs
- Single log sources rarely provide full visibility
- Effective detection depends on multi-source correlation

---

## 8) Links / Resources

- TryHackMe room: GeoServer – Known Vulnerability  
- CVE-2025-58360 (NVD)  
- GeoServer official documentation  
- Elastic & Kibana logging documentation  

---
