# [Vulnerability Capstone] — TryHackMe - Junior Pentester  
**Date:** 2025-10-09  
**Type:** Challenge  
**Scope:** Lab / Authorized only

---

## 1) Context  
Apply all knowledge from the **Vulnerability Module**: identify a vulnerable application, research its CVE, find or adapt a PoC, and achieve RCE in a legal and isolated lab environment.

## 2) Initial hypothesis  
Expected flow:  
1. Enumerate exposed services and identify the web application.  
2. Match its version to known CVEs.  
3. Locate PoCs (Exploit-DB, Rapid7, GitHub, Gist, Searchsploit).  
4. Adapt or fix the PoC (proxy removal, Python version, listener setup).  
5. Execute and confirm exploitation.  
I assumed PoCs would not be turnkey and would require small environment tweaks.

## 3) Tools used  
nmap, curl, Exploit-DB, Rapid7, GitHub/Gist, Searchsploit, Python2/3, netcat (listener).

## 4) Approach (high level)  
- **Recon:** scanned host → found HTTP (80) and SSH (22).  
- **Fingerprinting:** browsed to web service; app name and version displayed clearly.  
- **Research:** searched multiple databases for RCE affecting that version; confirmed CVE.  
- **Testing PoCs:** tried two Exploit-DB scripts (`50477.py`, `47138.py`) — one returned meaningless output, the other failed due to proxy settings.  
- **Adaptation:** found a working PoC on GitHub Gist; removed proxy configuration, started listener, achieved reverse shell.  
- **Verification:** captured shell output, retrieved flag, documented source and changes.

## 5) Results / Evidence (sanitized)  
- Application name and version identified via web page.  
- Associated RCE CVE found (from Exploit-DB).  
- First two PoCs ineffective: one non-interactive, one proxy-blocked.  
- Third PoC from Gist executed successfully after proxy fix and listener setup.  
- Confirmed command execution on target system.

## 6) Recommended remediation  
- Keep **web applications patched** to latest stable versions.  
- Monitor for **public PoCs** and update quickly when exploits are released.  
- Disable unnecessary services and isolate management interfaces.  
- Harden web servers with **least privilege** and **input sanitization**.  
- Perform **regular vulnerability scans** and **manual validation** to catch outdated components.

## 7) Lessons learned  
- **Multiple sources** (Exploit-DB, Rapid7, GitHub) must be checked — official databases don’t always have the working PoC.  
- **Read the script** before running — check Python version, proxy usage, and parameters.  
- **Unset proxies** if PoCs rely on local Burp configs (`unset HTTP_PROXY HTTPS_PROXY`).  
- **Always start listener first** for reverse-shell PoCs.  
- Minor edits often make PoCs work — small fixes matter.  
- Document provenance: exact URL, commit, and modifications for reproducibility.

## 8) Links / Resources  
- [Exploit-DB](https://www.exploit-db.com/)  
- [Rapid7 Vulnerability & Exploit Database](https://www.rapid7.com/db/)  
- [GitHub Gist PoC](https://gist.github.com/anir0y/8529960c18e212948b0e40ed1fb18d6d#file-fuel-cms-py)  
- [Searchsploit](https://www.exploit-db.com/searchsploit)  
- [NVD](https://nvd.nist.gov/)

---